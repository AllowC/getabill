<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Data Entry, Modification, and Download</title>  
    <style>  
        body {  
            font-family: Arial, sans-serif;  
            margin: 20px;  
            padding: 20px;  
            background-color: #f9f9f9;  
        }  
        .container {  
            max-width: 600px;  
            margin: 0 auto;  
            background: #fff;  
            padding: 20px;  
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);  
        }  
        h1 {  
            text-align: center;  
        }  
        form {  
            display: flex;  
            flex-direction: column;  
        }  
        label {  
            margin-top: 10px;  
            margin-bottom: 5px;  
        }  
        input, button {  
            margin-top: 10px;  
            padding: 10px;  
            font-size: 16px;  
        }  
        button {  
            cursor: pointer;  
            background-color: #007bff;  
            color: #fff;  
            border: none;  
            border-radius: 5px;  
        }  
        button:hover {  
            background-color: #0056b3;  
        }  
        .file-input {  
            margin-top: 20px;  
        }  
    </style>  
</head>  
<body>  
    <div class="container">  
        <h1>Data Entry, Modification, and Download</h1>  
        <form id="dataForm">  
            <label for="name">Name:</label>  
            <input type="text" id="name" name="name" required>  
            <label for="salary">Salary:</label>  
            <input type="number" id="salary" name="salary" step="0.01" required>  
            <button type="button" onclick="addData()">Add Data</button>  
            <div class="file-input">  
                <label for="fileUpload">Upload JSON File:</label>  
                <input type="file" id="fileUpload" accept=".json" onchange="loadJSON(event)">  
            </div>  
        </form>  
        <button type="button" onclick="downloadData()">Download JSON</button>  
        <pre id="dataPreview" style="white-space: pre-wrap; word-wrap: break-word; max-height: 200px; overflow-y: auto; margin-top: 20px; background: #f5f5f5; padding: 10px;"></pre>  
    </div>  
  
    <script>  
        let dataArray = [];  
  
        function addData() {  
            const name = document.getElementById('name').value;  
            const salary = parseFloat(document.getElementById('salary').value);  
              
            if (name && !isNaN(salary)) {  
                dataArray.push({ name, salary });  
                updatePreview();  
                  
                // 清空输入框  
                document.getElementById('dataForm').reset();  
            } else {  
                alert('Please fill in all fields correctly.');  
            }  
        }  
  
        function loadJSON(event) {  
            const file = event.target.files[0];  
            if (file) {  
                const reader = new FileReader();  
                reader.onload = function(e) {  
                    try {  
                        const jsonData = JSON.parse(e.target.result);  
                        if (Array.isArray(jsonData)) {  
                            dataArray = jsonData;  
                            updatePreview();  
                        } else {  
                            alert('Uploaded file is not a valid JSON array.');  
                        }  
                    } catch (error) {  
                        alert('Error parsing JSON file: ' + error.message);  
                    }  
                };  
                reader.readAsText(file);  
            }  
        }  
  
        function downloadData() {  
            const jsonString = JSON.stringify(dataArray, null, 2);  
            const blob = new Blob([jsonString], { type: 'application/json' });  
            const url = URL.createObjectURL(blob);  
              
            const a = document.createElement('a');  
            a.href = url;  
            a.download = 'data.json';  
            document.body.appendChild(a);  
            a.click();  
              
            document.body.removeChild(a);  
            URL.revokeObjectURL(url);  
        }  
  
        function updatePreview() {  
            const previewElement = document.getElementById('dataPreview');  
            previewElement.textContent = JSON.stringify(dataArray, null, 2);  
        }  
  
        // 初始化时更新预览（可选）  
        updatePreview();  
    </script>  
</body>  
</html>
